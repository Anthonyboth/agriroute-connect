<!DOCTYPE html>
<html lang="pt-BR" translate="no">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=0.5, maximum-scale=3.0, user-scalable=yes" />
    <meta name="google" content="notranslate" />
    
    <link rel="icon" href="/favicon.ico?v=5" sizes="any">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png?v=5">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png?v=5">
    
    <!-- Apple Touch Icons -->
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="AgriRoute">
    
    <!-- ✅ Capacitor/Native cleanup: remove PWA/preload/preconnect tags that crash Android WebView -->
    <script>
      (function(){
        var isNative = window.Capacitor || location.protocol === 'capacitor:' || 
          (location.hostname === 'localhost' && !location.port);
        if (!isNative) return;
        window.__CAPACITOR_NATIVE__ = true;
        function cleanup(){
          document.querySelectorAll('link[rel="manifest"]').forEach(function(el){ el.remove(); });
          document.querySelectorAll('link[rel="preload"][as="image"]').forEach(function(el){ el.remove(); });
          document.querySelectorAll('link[rel="preconnect"], link[rel="dns-prefetch"]').forEach(function(el){ el.remove(); });
        }
        cleanup();
        new MutationObserver(cleanup).observe(document.head, { childList: true });
      })();
    </script>

    <!-- Android/Chrome PWA -->
    <link rel="manifest" href="/site.webmanifest?v=2">
    <meta name="theme-color" content="#10b981">
    <meta name="mobile-web-app-capable" content="yes">
    
    <!-- Windows Tiles -->
    <meta name="msapplication-TileColor" content="#10b981">
    <meta name="msapplication-config" content="/browserconfig.xml">
    
    <!-- LCP image preload - URLs must match React-rendered src (no version param) -->
    <link rel="preload" as="image" type="image/webp" fetchpriority="high"
          imagesrcset="/hero-truck-night-moon-mobile.webp 640w, /hero-truck-night-moon.webp 1920w"
          imagesizes="100vw">
    
    <!-- Preconnect to critical origins - reduces DNS/TLS latency -->
    <link rel="preconnect" href="https://shnvtxejjecbnztdbbbl.supabase.co" crossorigin>
    <link rel="dns-prefetch" href="https://shnvtxejjecbnztdbbbl.supabase.co">
    
    <!-- DNS prefetch for external services -->
    <link rel="dns-prefetch" href="https://js.stripe.com">
    <link rel="dns-prefetch" href="https://api.stripe.com">
    <link rel="dns-prefetch" href="https://wa.me">
    
    <!-- Inline Critical CSS for LCP optimization + CLS prevention -->
    <style>
      /* Reset & Base */
      *{box-sizing:border-box;margin:0;padding:0}
      body{font-family:system-ui,-apple-system,sans-serif;line-height:1.5;-webkit-font-smoothing:antialiased;overflow-x:hidden}
      
      /* Prevent layout shifts from fonts */
      @font-face{font-family:system-ui;font-display:swap}
      
      /* Hero section base - FIXED HEIGHT to prevent CLS */
      .hero-section{position:relative;min-height:100vh;height:100vh;width:100%;display:flex;align-items:center;justify-content:center;overflow:hidden}
      .hero-section>picture,
      .hero-section>img{position:absolute;inset:0;width:100%;height:100%;object-fit:cover;z-index:0}
      .hero-section::before{content:"";position:absolute;inset:0;background:linear-gradient(90deg,rgba(0,0,0,0.9) 0%,rgba(0,0,0,0.5) 50%,transparent 100%);z-index:1}
      
      /* Hero content - FIXED LAYOUT */
      .hero-content{position:relative;z-index:10;max-width:80rem;margin:0 auto;padding:3rem 1.5rem;text-align:center;will-change:transform}
      .hero-content h1{font-size:clamp(2rem,5vw,4rem);font-weight:700;color:#fff;line-height:1.2;margin-bottom:2rem;contain:layout style paint}
      .text-gradient-hero{background:linear-gradient(135deg,#10b981,#22c55e,#84cc16);-webkit-background-clip:text;background-clip:text;color:transparent}
      
      /* Hero buttons - FIXED SIZE to prevent CLS */
      .gradient-primary{background:linear-gradient(135deg,#10b981,#059669);color:#fff;border:none;padding:1.25rem 2rem;border-radius:9999px;font-weight:600;font-size:1.125rem;display:inline-flex;align-items:center;gap:0.5rem;cursor:pointer;box-shadow:0 10px 30px -10px rgba(16,185,129,0.5);transition:all 0.3s cubic-bezier(0.4,0,0.2,1);min-width:200px;justify-content:center}
      .gradient-primary:hover{transform:scale(1.05);box-shadow:0 20px 40px -10px rgba(16,185,129,0.6)}
      
      /* Header - FIXED HEIGHT to prevent CLS */
      header{position:sticky;top:0;z-index:50;background:rgba(255,255,255,0.8);backdrop-filter:blur(12px);border-bottom:1px solid rgba(0,0,0,0.1);height:72px;contain:layout style}
      header .container{max-width:80rem;margin:0 auto;padding:1rem;display:flex;align-items:center;justify-content:space-between;height:100%}
      
      /* Layout utilities */
      .container{max-width:80rem;margin:0 auto;padding:0 1rem}
      .flex{display:flex}
      .items-center{align-items:center}
      .justify-center{justify-content:center}
      .justify-between{justify-content:space-between}
      .gap-4{gap:1rem}
      .space-x-2>*+*{margin-left:0.5rem}
      .space-x-4>*+*{margin-left:1rem}
      
      /* Loading skeleton - FIXED HEIGHT to prevent CLS */
      .skeleton{background:linear-gradient(90deg,#f3f4f6 25%,#e5e7eb 50%,#f3f4f6 75%);background-size:200% 100%;animation:shimmer 1.5s infinite;min-height:200px}
      @keyframes shimmer{0%{background-position:200% 0}100%{background-position:-200% 0}}
      
      /* Prevent images from causing CLS */
      img{max-width:100%;height:auto;display:block}
      img[width][height]{aspect-ratio:attr(width)/attr(height)}
    </style>
    
    <!-- CSS async loading - prevents render blocking (WEB ONLY) -->
    <script>
      (function(){
        // ✅ SKIP on Capacitor/native: onload may never fire for local files in Android WebView
        // causing CSS to stay on media='print' forever → blank/flashing screen
        var isNative = window.Capacitor || location.protocol === 'capacitor:' || 
          (location.hostname === 'localhost' && !location.port);
        if (isNative) return;
        
        function makeAsync(link){
          if(link.href&&link.href.includes('/assets/')&&link.rel==='stylesheet'){
            link.media='print';
            link.onload=function(){this.media='all';this.onload=null;};
          }
        }
        // Handle existing links
        document.querySelectorAll('link[rel="stylesheet"]').forEach(makeAsync);
        // Catch dynamically added links via MutationObserver
        new MutationObserver(function(mutations){
          mutations.forEach(function(m){
            m.addedNodes.forEach(function(n){
              if(n.tagName==='LINK')makeAsync(n);
            });
          });
        }).observe(document.head,{childList:true});
      })();
    </script>
    <noscript><link rel="stylesheet" href="/assets/index.css"></noscript>
    
    <title>AgriRoute - Logística Agrícola Inteligente</title>
    <meta name="description" content="Ambiente digital para orquestrar, conectar e monitorar o transporte agrícola. Conecte produtores rurais e motoristas com eficiência e segurança." />
    <meta name="author" content="AgriRoute" />
    
    <!-- Canonical URL - signals preferred domain to search engines -->
    <link rel="canonical" href="https://agriroute-connect.com.br/" />

    <meta property="og:title" content="AgriRoute - Logística Agrícola Inteligente" />
    <meta property="og:url" content="https://agriroute-connect.com.br/" />
    <meta property="og:description" content="Ambiente digital para orquestrar, conectar e monitorar o transporte agrícola. Conecte produtores rurais e motoristas com eficiência e segurança." />
    <meta property="og:type" content="website" />
    <meta property="og:image" content="/android-chrome-512x512.png?v=2" />

    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:site" content="@lovable_dev" />
    <meta name="twitter:image" content="/android-chrome-512x512.png?v=2" />
  </head>

  <body>
    <div id="root">
      <!-- App Shell: logged-in users see spinner, others see Landing shell -->
      <div id="app-shell-spinner" style="display:none;position:fixed;inset:0;z-index:50;background:hsl(0 0% 100%);display:none;align-items:center;justify-content:center">
        <div style="width:48px;height:48px;border:2px solid #10b981;border-top-color:transparent;border-radius:50%;animation:spin 1s linear infinite"></div>
        <style>@keyframes spin{to{transform:rotate(360deg)}}</style>
      </div>
      <div id="app-shell-landing">
        <header style="position:sticky;top:0;z-index:50;background:rgba(255,255,255,0.9);backdrop-filter:blur(12px);border-bottom:1px solid rgba(0,0,0,0.1);height:72px">
          <div style="max-width:80rem;margin:0 auto;padding:1rem;display:flex;align-items:center;justify-content:space-between;height:100%">
            <div style="display:flex;align-items:center;gap:0.5rem">
              <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="#10b981" stroke-width="2">
                <path d="M11 20A7 7 0 0 1 9.8 6.1C15.5 5 17 4.48 19 2c1 2 2 4.18 2 8 0 5.5-4.78 10-10 10Z"/>
              </svg>
              <span style="font-size:1.5rem;font-weight:700;color:#0a0a0a">AgriRoute</span>
            </div>
          </div>
        </header>
        <section class="hero-section" style="position:relative;min-height:100vh;display:flex;align-items:center;justify-content:center;background:#1a1a1a">
          <!-- LCP Image - URLs match React/hook output (no version param) for preload hit -->
          <picture>
            <source media="(max-width: 640px)" srcset="/hero-truck-night-moon-mobile.webp" type="image/webp">
            <source media="(min-width: 641px)" srcset="/hero-truck-night-moon.webp" type="image/webp">
            <img 
              src="/hero-truck-night-moon-mobile.webp" 
              srcset="/hero-truck-night-moon-mobile.webp 640w, /hero-truck-night-moon.webp 1920w"
              sizes="100vw"
              alt="Logística agrícola moderna - caminhão transportando carga agrícola" 
              style="position:absolute;inset:0;width:100%;height:100%;object-fit:cover;z-index:0"
              width="1920" 
              height="1080"
              fetchpriority="high"
              loading="eager"
              decoding="async"
            >
          </picture>
          <div style="position:absolute;inset:0;background:linear-gradient(90deg,rgba(0,0,0,0.9) 0%,rgba(0,0,0,0.5) 50%,transparent 100%);z-index:1"></div>
          <div style="position:relative;z-index:10;text-align:center;padding:2rem">
            <h1 style="font-size:clamp(2rem,5vw,4rem);font-weight:700;color:#fff;margin-bottom:2rem">
              Conectando Quem Precisa<br>
              <span style="background:linear-gradient(135deg,#10b981,#22c55e);-webkit-background-clip:text;background-clip:text;color:transparent">a Quem Resolve</span>
            </h1>
            <div style="display:flex;flex-direction:column;gap:1rem;align-items:center">
              <div style="width:200px;height:56px;background:linear-gradient(135deg,#10b981,#059669);border-radius:9999px"></div>
              <div style="width:200px;height:56px;background:#f59e0b;border-radius:9999px"></div>
            </div>
          </div>
        </section>
      </div>
      <script>
        // If user has cached session, show spinner instead of Landing shell
        try {
          if (localStorage.getItem('sb-shnvtxejjecbnztdbbbl-auth-token')) {
            document.getElementById('app-shell-landing').style.display = 'none';
            var sp = document.getElementById('app-shell-spinner');
            sp.style.display = 'flex';
          }
        } catch(e) {}
      </script>
    </div>
    <script type="module" src="/src/main.tsx"></script>
  </body>
</html>
